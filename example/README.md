# BaseSQL 示例

本目录包含 BaseSQL 的使用示例，展示如何使用 GORM 集成来操作飞书多维表格。

## 文件说明

- `simple_demo.go` - 基本的 GORM 集成示例，展示完整的 CRUD 操作
- `.env.example` - 环境变量配置模板
- `README.md` - 本说明文档

## 快速开始

### 1. 配置飞书应用

首先，您需要在飞书开放平台创建应用并获取凭据：

1. 访问 [飞书开放平台](https://open.feishu.cn/)
2. 创建企业自建应用
3. 获取 App ID 和 App Secret
4. 在多维表格中获取 App Token
5. 确保应用具有多维表格的读写权限

### 2. 设置环境变量

**推荐方式：使用环境变量文件**

```bash
# 复制配置模板
cp .env.example .env

# 编辑 .env 文件，填入您的飞书应用凭据
# FEISHU_APP_ID=your_app_id
# FEISHU_APP_SECRET=your_app_secret
# FEISHU_APP_TOKEN=your_app_token
# DEBUG_MODE=true
```

**替代方式：直接设置环境变量**

```bash
export FEISHU_APP_ID=your_app_id
export FEISHU_APP_SECRET=your_app_secret
export FEISHU_APP_TOKEN=your_app_token
export DEBUG_MODE=true
```

### 3. 运行示例

```bash
# 直接运行源码
go run simple_demo.go

# 或者编译后运行
go build -o simple_demo simple_demo.go
./simple_demo
```

## 示例功能

`simple_demo.go` 演示了完整的 CRUD 操作流程和字段类型支持：

### 基础功能
- ✅ **连接验证** - 数据库连接和配置验证
- ✅ **自动迁移** - 自动创建和更新表结构
- ✅ **查询操作** - 查询现有数据和条件查询
- ✅ **创建操作** - 插入新用户记录
- ✅ **更新操作** - 修改用户信息
- ✅ **删除操作** - 删除用户记录
- ✅ **事务处理** - 演示数据库事务的使用

### 字段类型支持
- ✅ **多行文本** - 支持换行符的长文本
- ✅ **单行文本** - 简短文本内容
- ✅ **数字** - 整数和浮点数
- ✅ **复选框** - 布尔值 true/false
- ✅ **日期** - 日期时间类型
- ✅ **链接** - URL格式链接
- ✅ **多选** - 多个选项的数组
- ✅ **单选** - 单个选项值
- ✅ **人员** - 人员信息

### SQL操作符支持
- ✅ **等于比较** - `=` 操作符
- ✅ **模式匹配** - `LIKE` 操作符，支持 `%` 通配符
- ✅ **集合操作** - `IN` 和 `NOT IN` 操作符
- ✅ **空值检查** - `IS NULL` 和 `IS NOT NULL`
- ✅ **数值比较** - `>`, `<`, `>=`, `<=` 操作符
- ✅ **布尔操作** - `= true` 和 `= false`

## 执行流程

程序运行时会按以下顺序执行操作：

1. **环境配置加载** - 自动加载 .env 文件中的配置
2. **连接数据库** - 使用飞书多维表格作为数据库后端
3. **表结构迁移** - 自动创建 User 表结构
4. **数据查询** - 查询现有用户数据
5. **用户创建** - 创建新的用户记录
6. **条件查询** - 查找符合条件的用户
7. **数据更新** - 更新用户信息
8. **数据删除** - 删除指定用户
9. **资源清理** - 关闭数据库连接

## 注意事项

### 权限和配置
- 🔑 确保飞书应用具有多维表格的读写权限
- 📋 首次运行时会自动创建表结构，无需手动创建
- ⚠️ 请妥善保管您的应用凭据，不要提交到版本控制系统
- 🔧 如果遇到配置错误，程序会显示详细的配置指南

### 数据存储
- 🗄️ 数据直接存储在飞书多维表格中，非内存数据库
- 📊 支持飞书多维表格的所有核心字段类型
- 🔄 自动处理 Go 类型与飞书字段类型的转换

### 性能和稳定性
- ⚡ 内置连接池、限流器、熔断器等稳定性组件
- 🔄 支持智能重试和错误恢复
- 📈 提供详细的性能监控和统计信息

## 故障排除

**常见问题：**

1. **"App ID 不能为空"** - 检查 .env 文件是否正确配置
2. **"权限不足"** - 确认飞书应用具有多维表格权限
3. **"连接失败"** - 检查网络连接和应用凭据是否正确

**调试模式：**

设置 `DEBUG_MODE=true` 可以查看详细的调试信息。